<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot of 2D CA projection of the data. — ca_biplot • APL</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot of 2D CA projection of the data. — ca_biplot"><meta name="description" content="Plots the first 2 dimensions of the rows and columns in the same plot."><meta property="og:description" content="Plots the first 2 dimensions of the rows and columns in the same plot."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">APL</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/APL.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot of 2D CA projection of the data.</h1>

      <div class="d-none name"><code>ca_biplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots the first 2 dimensions of the rows and columns in the same plot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ca_biplot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  xdim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ydim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  princ_coords <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  col_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'cacomp'</span></span>
<span><span class="fu">ca_biplot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  xdim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ydim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  princ_coords <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  col_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Seurat'</span></span>
<span><span class="fu">ca_biplot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  xdim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ydim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  princ_coords <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  col_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  assay <span class="op">=</span> <span class="fu">SeuratObject</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"counts"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">ca_biplot</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  xdim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ydim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  princ_coords <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  col_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  assay <span class="op">=</span> <span class="st">"counts"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>An object of class "cacomp" with the relevant standardized and
principal coordinates calculated,
 or alternatively an object of class "Seurat" or "SingleCellExperiment"
 with a dim. reduction named "CA" saved.</p></dd>


<dt id="arg-xdim">xdim<a class="anchor" aria-label="anchor" href="#arg-xdim"></a></dt>
<dd><p>Integer. The dimension for the x-axis. Default 1.</p></dd>


<dt id="arg-ydim">ydim<a class="anchor" aria-label="anchor" href="#arg-ydim"></a></dt>
<dd><p>Integer. The dimension for the y-axis. Default 2.</p></dd>


<dt id="arg-princ-coords">princ_coords<a class="anchor" aria-label="anchor" href="#arg-princ-coords"></a></dt>
<dd><p>Integer. If 1 then principal coordinates are used for
the rows,
if 2 for the columns. Default 1 (rows).</p></dd>


<dt id="arg-row-labels">row_labels<a class="anchor" aria-label="anchor" href="#arg-row-labels"></a></dt>
<dd><p>Numeric vector. Indices for the rows for which a label
should be added
(label should be stored in rownames). Default NULL.</p></dd>


<dt id="arg-col-labels">col_labels<a class="anchor" aria-label="anchor" href="#arg-col-labels"></a></dt>
<dd><p>Numeric vector. Indices for the columns for which a label
should be added
(label should be stored in colnames).
Default NULL (no columns).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>String. Type of plot to draw. Either "ggplot" or "plotly".
Default "ggplot".</p></dd>


<dt id="arg-col-metadata">col_metadata<a class="anchor" aria-label="anchor" href="#arg-col-metadata"></a></dt>
<dd><p>named vector of additional metadata to color points.
The names of the elements in col_metadata should correspond to the column
names in 'obj'. If NULL columns will be in a single color. Can also specify
a metadata column for Seurat/SingleCellExperiment objects.</p></dd>


<dt id="arg-row-metadata">row_metadata<a class="anchor" aria-label="anchor" href="#arg-row-metadata"></a></dt>
<dd><p>named vector of additional metadata to color points.
The names of the elements in row_metadata should correspond to the row
names in 'obj'. If NULL rows will be in a single color. Can also specify
a metadata column for Seurat/SingleCellExperiment objects.</p></dd>


<dt id="arg-show-all">show_all<a class="anchor" aria-label="anchor" href="#arg-show-all"></a></dt>
<dd><p>logical. If FALSE cells/genes that are not in col_metadata/
row_metadata are not plotted. If *_metadata is NULL, the cell or genes
respectively will still be plotted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>SingleCellExperiment assay for recomputation</p></dd>


<dt id="arg-slot">slot<a class="anchor" aria-label="anchor" href="#arg-slot"></a></dt>
<dd><p>Seurat assay slot from which to get matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Plot of class "plotly" or "ggplot".</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Choosing type "plotly" will generate an interactive html plot with the
package plotly.
Type "ggplot" generates a static plot.
Depending on whether `princ_coords` is set to 1 or 2 either
the principal coordinates of either the rows (1) or the columns (2)
are chosen. For the other the standard coordinates are plotted
(assymetric biplot).
Labels for rows and columns should be stored in the row and column names
respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate counts</span></span></span>
<span class="r-in"><span><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>               x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run correspondence analysis</span></span></span>
<span class="r-in"><span><span class="va">ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="cacomp.html">cacomp</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">cnts</span>, princ_coords <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Parameter top is &gt;nrow(obj) and therefore ignored.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No dimensions specified. Setting dimensions to: 9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ca_biplot</span><span class="op">(</span><span class="va">ca</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown aesthetics: <span style="color: #00BB00;">text</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown aesthetics: <span style="color: #00BB00;">text</span></span>
<span class="r-plt img"><img src="ca_biplot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clemens Kohl, Elzbieta Gralinska, Martin Vingron.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

