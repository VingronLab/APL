<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute and plot Association Plot — runAPL • APL</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute and plot Association Plot — runAPL"><meta property="og:description" content='Computes singular value decomposition and coordinates for 
the Association Plot.
runAPL.SingleCellExperiment: Computes singular value decomposition and 
coordinates for the Association Plot from SingleCellExperiment objects with 
reducedDim(obj, "CA") slot (optional).
runAPL.Seurat: Computes singular value decomposition and coordinates for 
the Association Plot from Seurat objects, optionally with a DimReduc Object 
in the "CA" slot.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">APL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/APL.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute and plot Association Plot</h1>
    
    <div class="hidden name"><code>runAPL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes singular value decomposition and coordinates for 
the Association Plot.</p>
<p>runAPL.SingleCellExperiment: Computes singular value decomposition and 
coordinates for the Association Plot from SingleCellExperiment objects with 
reducedDim(obj, "CA") slot (optional).</p>
<p>runAPL.Seurat: Computes singular value decomposition and coordinates for 
the Association Plot from Seurat objects, optionally with a DimReduc Object 
in the "CA" slot.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">runAPL</span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">group</span>,
  caobj <span class="op">=</span> <span class="cn">NULL</span>,
  dims <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="fl">10</span>,
  top <span class="op">=</span> <span class="fl">5000</span>,
  score <span class="op">=</span> <span class="cn">TRUE</span>,
  mark_rows <span class="op">=</span> <span class="cn">NULL</span>,
  mark_cols <span class="op">=</span> <span class="va">caobj</span><span class="op">@</span><span class="va">group</span>,
  reps <span class="op">=</span> <span class="fl">3</span>,
  python <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  type <span class="op">=</span> <span class="st">"plotly"</span>,
  show_cols <span class="op">=</span> <span class="cn">FALSE</span>,
  show_rows <span class="op">=</span> <span class="cn">TRUE</span>,
  score_cutoff <span class="op">=</span> <span class="fl">0</span>,
  score_color <span class="op">=</span> <span class="st">"rainbow"</span>,
  pd_method <span class="op">=</span> <span class="st">"elbow_rule"</span>,
  pd_reps <span class="op">=</span> <span class="fl">1</span>,
  pd_use <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for matrix</span>
<span class="fu">runAPL</span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">group</span>,
  caobj <span class="op">=</span> <span class="cn">NULL</span>,
  dims <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="fl">10</span>,
  top <span class="op">=</span> <span class="fl">5000</span>,
  score <span class="op">=</span> <span class="cn">TRUE</span>,
  mark_rows <span class="op">=</span> <span class="cn">NULL</span>,
  mark_cols <span class="op">=</span> <span class="cn">NULL</span>,
  reps <span class="op">=</span> <span class="fl">3</span>,
  python <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  type <span class="op">=</span> <span class="st">"plotly"</span>,
  show_cols <span class="op">=</span> <span class="cn">FALSE</span>,
  show_rows <span class="op">=</span> <span class="cn">TRUE</span>,
  score_cutoff <span class="op">=</span> <span class="fl">0</span>,
  score_color <span class="op">=</span> <span class="st">"rainbow"</span>,
  pd_method <span class="op">=</span> <span class="st">"elbow_rule"</span>,
  pd_reps <span class="op">=</span> <span class="fl">1</span>,
  pd_use <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for SingleCellExperiment</span>
<span class="fu">runAPL</span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">group</span>,
  caobj <span class="op">=</span> <span class="cn">NULL</span>,
  dims <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="fl">10</span>,
  top <span class="op">=</span> <span class="fl">5000</span>,
  score <span class="op">=</span> <span class="cn">TRUE</span>,
  mark_rows <span class="op">=</span> <span class="cn">NULL</span>,
  mark_cols <span class="op">=</span> <span class="cn">NULL</span>,
  reps <span class="op">=</span> <span class="fl">3</span>,
  python <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  type <span class="op">=</span> <span class="st">"plotly"</span>,
  show_cols <span class="op">=</span> <span class="cn">FALSE</span>,
  show_rows <span class="op">=</span> <span class="cn">TRUE</span>,
  score_cutoff <span class="op">=</span> <span class="fl">0</span>,
  score_color <span class="op">=</span> <span class="st">"rainbow"</span>,
  pd_method <span class="op">=</span> <span class="st">"elbow_rule"</span>,
  pd_reps <span class="op">=</span> <span class="fl">1</span>,
  pd_use <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>,
  assay <span class="op">=</span> <span class="st">"counts"</span>
<span class="op">)</span>

<span class="co"># S4 method for Seurat</span>
<span class="fu">runAPL</span><span class="op">(</span>
  <span class="va">obj</span>,
  <span class="va">group</span>,
  caobj <span class="op">=</span> <span class="cn">NULL</span>,
  dims <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="fl">10</span>,
  top <span class="op">=</span> <span class="fl">5000</span>,
  score <span class="op">=</span> <span class="cn">TRUE</span>,
  mark_rows <span class="op">=</span> <span class="cn">NULL</span>,
  mark_cols <span class="op">=</span> <span class="cn">NULL</span>,
  reps <span class="op">=</span> <span class="fl">3</span>,
  python <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labs <span class="op">=</span> <span class="cn">TRUE</span>,
  type <span class="op">=</span> <span class="st">"plotly"</span>,
  show_cols <span class="op">=</span> <span class="cn">FALSE</span>,
  show_rows <span class="op">=</span> <span class="cn">TRUE</span>,
  score_cutoff <span class="op">=</span> <span class="fl">0</span>,
  score_color <span class="op">=</span> <span class="st">"rainbow"</span>,
  pd_method <span class="op">=</span> <span class="st">"elbow_rule"</span>,
  pd_reps <span class="op">=</span> <span class="fl">1</span>,
  pd_use <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>,
  assay <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DefaultAssay.html" class="external-link">DefaultAssay</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>,
  slot <span class="op">=</span> <span class="st">"counts"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>A numeric matrix, Seurat or SingleCellExperiment object. For 
sequencing a count matrix, gene expression values with genes in rows and 
samples/cells in columns.
Should contain row and column names.</p></dd>
<dt>group</dt>
<dd><p>Numeric/Character. Vector of indices or column names of the 
columns to calculate centroid/x-axis direction.</p></dd>
<dt>caobj</dt>
<dd><p>A "cacomp" object as outputted from `cacomp()`. If not supplied 
will be calculated. Default NULL.</p></dd>
<dt>dims</dt>
<dd><p>Integer. Number of dimensions to keep. Default NULL (keeps all 
dimensions).</p></dd>
<dt>nrow</dt>
<dd><p>Integer. The top nrow scored row labels will be added to the 
plot if score = TRUE. Default 10.</p></dd>
<dt>top</dt>
<dd><p>Integer. Number of most variable rows to retain. Default 5000 
rows (set NULL to keep all).</p></dd>
<dt>score</dt>
<dd><p>Logical. Whether rows should be scored and ranked. Ignored when 
a vector is supplied to mark_rows. Default TRUE.</p></dd>
<dt>mark_rows</dt>
<dd><p>Character vector. Names of rows that should be highlighted 
in the plot. If not NULL, score is ignored. Default NULL.</p></dd>
<dt>mark_cols</dt>
<dd><p>Character vector. Names of cols that should be highlighted 
in the plot.</p></dd>
<dt>reps</dt>
<dd><p>Integer. Number of permutations during scoring. Default 3.</p></dd>
<dt>python</dt>
<dd><p>A logical value indicating whether to use singular value 
decomposition from the python package torch.
This implementation dramatically speeds up computation compared to `svd()` 
in R.</p></dd>
<dt>row_labs</dt>
<dd><p>Logical. Whether labels for rows indicated by rows_idx 
should be labeled with text. Default TRUE.</p></dd>
<dt>col_labs</dt>
<dd><p>Logical. Whether labels for columns indicated by cols_idx 
should be labeled with text. Default TRUE.</p></dd>
<dt>type</dt>
<dd><p>"ggplot"/"plotly". For a static plot a string "ggplot", for an 
interactive plot "plotly". Default "plotly".</p></dd>
<dt>show_cols</dt>
<dd><p>Logical. Whether column points should be plotted.</p></dd>
<dt>show_rows</dt>
<dd><p>Logical. Whether row points should be plotted.</p></dd>
<dt>score_cutoff</dt>
<dd><p>Numeric. Rows (genes) with a score &gt;= score_cutoff
will be colored according to their score if show_score = TRUE.</p></dd>
<dt>score_color</dt>
<dd><p>Either "rainbow" or "viridis".</p></dd>
<dt>pd_method</dt>
<dd><p>Which method to use for pick_dims (<a href="pick_dims.html">pick_dims</a>).</p></dd>
<dt>pd_reps</dt>
<dd><p>Number of repetitions performed when using "elbow_rule" in 
`pick_dims`.
(<a href="pick_dims.html">pick_dims</a>)</p></dd>
<dt>pd_use</dt>
<dd><p>Whether to use `pick_dims` (<a href="pick_dims.html">pick_dims</a>) to determine
the number of dimensions. Ignored when `dims` is set by the user.</p></dd>
<dt>...</dt>
<dd><p>Arguments forwarded to methods.</p></dd>
<dt>assay</dt>
<dd><p>Character. The assay from which extract the count matrix for 
SVD, e.g. "RNA" for Seurat objects or "counts"/"logcounts" for 
SingleCellExperiments.</p></dd>
<dt>slot</dt>
<dd><p>character. The Seurat assay slot from which to extract the 
count matrix.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Association Plot (plotly object).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function is a wrapper that calls `cacomp()`, `apl_coords()`, 
`apl_score()` and finally `apl()` for ease of use.
The chosen defaults are most useful for genomics experiments, but for more 
fine grained control the functions
can be also run individually for the same results.
If score = FALSE, nrow and reps are ignored. If mark_rows is not NULL score 
is treated as if FALSE.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Association Plots: Visualizing associations in high-dimensional 
correspondence analysis biplots <br>
Elzbieta Gralinska, Martin Vingron <br>
bioRxiv 2020.10.23.352096; doi: https://doi.org/10.1101/2020.10.23.352096 <br></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulate counts</span></span>
<span class="r-in"><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">}</span>,</span>
<span class="r-in">               x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># (nonsensical) APL</span></span>
<span class="r-in"><span class="fu">runAPL</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">cnts</span>,</span>
<span class="r-in">       group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span class="r-in">       dims <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">       top <span class="op">=</span> <span class="fl">500</span>,</span>
<span class="r-in">       score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       show_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       type <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Both dims and pd_use set. Using dimensions specified by dims.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 10 dimensions.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class="r-plt img"><img src="runAPL-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">########################</span></span>
<span class="r-in"><span class="co"># SingleCellExperiment #</span></span>
<span class="r-in"><span class="co">########################</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulate counts</span></span>
<span class="r-in"><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">}</span>,</span>
<span class="r-in">               x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># (nonsensical) APL</span></span>
<span class="r-in"><span class="fu">runAPL</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">sce</span>,</span>
<span class="r-in">       group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span class="r-in">       dims <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">       top <span class="op">=</span> <span class="fl">500</span>,</span>
<span class="r-in">       score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       show_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span class="r-in">       assay <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Both dims and pd_use set. Using dimensions specified by dims.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 10 dimensions.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class="r-plt img"><img src="runAPL-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">###########</span></span>
<span class="r-in"><span class="co"># Seurat  #</span></span>
<span class="r-in"><span class="co">###########</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulate counts</span></span>
<span class="r-in"><span class="va">cnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">}</span>,</span>
<span class="r-in">               x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cnts</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">seu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">cnts</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following arguments are not used: row.names</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Feature names cannot have underscores ('_'), replacing with dashes ('-')</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># (nonsensical) APL</span></span>
<span class="r-in"><span class="fu">runAPL</span><span class="op">(</span>obj <span class="op">=</span> <span class="va">seu</span>,</span>
<span class="r-in">       group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span class="r-in">       dims <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">       top <span class="op">=</span> <span class="fl">500</span>,</span>
<span class="r-in">       score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       show_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">       type <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span class="r-in">       assay <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span class="r-in">       slot <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Both dims and pd_use set. Using dimensions specified by dims.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 10 dimensions.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class="r-plt img"><img src="runAPL-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Elzbieta Gralinska, Clemens Kohl, Martin Vingron.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

